from telebot import types
from debug_logger import debug_log, debug_decorator
from config import UserRole

@debug_decorator
def register_commands(bot):
    """
    ุซุจุช ุฏุณุชูุฑุงุช ุฑุจุงุช ุฏุฑ ููู ุชูฺฏุฑุงู

    Args:
        bot: ููููู ุฑุจุงุช ุชูฺฏุฑุงู
    """
    try:
        # ุฏุณุชูุฑุงุช ุนููู ุจุฑุง ููู ฺฉุงุฑุจุฑุงู
        commands = [
            types.BotCommand("start", "ุดุฑูุน ุฑุจุงุช ู ุฏุฑุงูุช ูพุงู ุฎูุดโุขูุฏฺฏู"),
            types.BotCommand("help", "ุฑุงูููุง ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุช"),
            types.BotCommand("download", "ุฏุงูููุฏ ูุฏู ุงุฒ ูุชูุจ"),
            types.BotCommand("status", "ูุดุงูุฏู ูุถุนุช ุณุณุชู"),
            types.BotCommand("mydownloads", "ูุดุงูุฏู ุฏุงูููุฏูุง ูู"),
        ]

        # ุฏุณุชูุฑุงุช ุงุฏูู
        admin_commands = commands + [
            types.BotCommand("admin_help", "ุฑุงูููุง ุฏุณุชูุฑุงุช ูุฏุฑุช"),
            types.BotCommand("users", "ูุดุงูุฏู ูุณุช ฺฉุงุฑุจุฑุงู"),
            types.BotCommand("block", "ูุณุฏูุฏ ฺฉุฑุฏู ฺฉุงุฑุจุฑ"),
            types.BotCommand("unblock", "ุฑูุน ูุณุฏูุฏุช ฺฉุงุฑุจุฑ"),
            types.BotCommand("setadmin", "ุชูุธู ฺฉุงุฑุจุฑ ุจู ุนููุงู ุงุฏูู"),
            types.BotCommand("setpremium", "ุชูุธู ฺฉุงุฑุจุฑ ุจู ุนููุงู ูฺู"),
            types.BotCommand("sysinfo", "ูุดุงูุฏู ุงุทูุงุนุงุช ุณุณุชู"),
            types.BotCommand("logs", "ูุดุงูุฏู ูุงฺฏโูุง ุงุฎุฑ"),
            types.BotCommand("broadcast", "ุงุฑุณุงู ูพุงู ุจู ููู ฺฉุงุฑุจุฑุงู"),
            types.BotCommand("downloads", "ูุดุงูุฏู ููู ุฏุงูููุฏูุง"),
            types.BotCommand("cancelall", "ูุบู ููู ุฏุงูููุฏูุง ุฏุฑ ุญุงู ุงูุฌุงู"),
        ]

        # ุชูุธู ุฏุณุชูุฑุงุช ุนููู
        bot.set_my_commands(commands)

        # ุชูุธู ุฏุณุชูุฑุงุช ุงุฏูู ุจุฑุง ุงุฏููโูุง (ุงฺฏุฑ API ูพุดุชุจุงู ฺฉูุฏ)
        try:
            # ุงู ูุงุจูุช ุฏุฑ ูุณุฎูโูุง ุฌุฏุฏุชุฑ ุชูฺฏุฑุงู ูุฌูุฏ ุฏุงุฑุฏ
            bot.set_my_commands(
                admin_commands,
                types.BotCommandScopeChat(config.ADMIN_IDS[0]) if config.ADMIN_IDS else None
            )
        except Exception:
            # ุงฺฏุฑ API ูพุดุชุจุงู ูฺฉุฑุฏุ ูุงุฏุฏู ูโฺฏุฑู
            pass

        debug_log("ุฏุณุชูุฑุงุช ุฑุจุงุช ุจุง ููููุช ุซุจุช ุดุฏูุฏ", "INFO")

    except Exception as e:
        debug_log(f"ุฎุทุง ุฏุฑ ุซุจุช ุฏุณุชูุฑุงุช ุฑุจุงุช: {str(e)}", "ERROR")

@debug_decorator
def generate_help_message(user_role: int = UserRole.NORMAL) -> str:
    """
    ุชููุฏ ูพุงู ุฑุงูููุง ุจุฑ ุงุณุงุณ ููุด ฺฉุงุฑุจุฑ

    Args:
        user_role: ููุด ฺฉุงุฑุจุฑ

    Returns:
        ูุชู ุฑุงูููุง
    """
    # ูพุงู ุฑุงูููุง ุนููู
    help_msg = """๐ฑ *ุฑุงูููุง ุฌุงูุน ุฑุจุงุช ุฏุงูููุฏ ูุฏู:*

๐ฅ *ุฏุงูููุฏ ูุฏู:*
โข ููฺฉ ูุชูุจ ุฑุง ูุณุชููุงู ุงุฑุณุงู ฺฉูุฏ
โข ุง ุงุฒ ุฏุณุชูุฑ `/download ููฺฉ` ุงุณุชูุงุฏู ฺฉูุฏ
โข ููฺฉโูุง ฺฉูุชุงู ู ุนุงุฏ ูพุดุชุจุงู ูโุดููุฏ
โข ูพุดุชุจุงู ุงุฒ Shorts ู ูุฏููุง ุนุงุฏ
โข ุงูฺฉุงู ุงูุชุฎุงุจ ฺฉูุช ุฏูุฎูุงู
โข ูุงุจูุช ูุบู ุฏุงูููุฏ ุฏุฑ ุญุงู ุงูุฌุงู

๐ *ุฏุณุชูุฑุงุช ุงุตู:*
โข `/start` - ุดุฑูุน ุฑุจุงุช
โข `/help` - ููุงุด ุฑุงูููุง
โข `/status` - ูุถุนุช ุณุณุชู
โข `/mydownloads` - ูุณุช ุฏุงูููุฏูุง

โ๏ธ *ุงูฺฉุงูุงุช:*
โข ูพุดุชุจุงู ุงุฒ ูุฏููุง ูุชูุจ
โข ุงูุชุฎุงุจ ฺฉูุช ุฏูุฎูุงู
โข ููุงุด ูพุดุฑูุช ุฏุงูููุฏ
โข ูุฏุฑุช ุฏุงูููุฏูุง ููุฒูุงู"""

    # ุงุถุงูู ฺฉุฑุฏู ุฑุงูููุง ูฺู ุจุฑุง ฺฉุงุฑุจุฑุงู ูฺู
    if user_role >= UserRole.PREMIUM:
        help_msg += """

โพ๏ธ *ุงูฺฉุงูุงุช ูฺู ุดูุง:*
  โข ุงูฺฉุงู ุฏุงูููุฏ ููุฒูุงู ุจุดุชุฑ
  โข ุฏุงูููุฏ ูุงูโูุง ุจุง ุญุฌู ุจุงูุงุชุฑ
  โข ุงูููุช ุฏุฑ ุตู ุฏุงูููุฏ"""

    # ุงุถุงูู ฺฉุฑุฏู ุฑุงูููุง ุงุฏูู ุจุฑุง ุงุฏููโูุง
    if user_role >= UserRole.ADMIN:
        help_msg += """

โพ๏ธ *ุฏุณุชูุฑุงุช ูุฏุฑุช:*
  `/admin_help` - ุฑุงูููุง ฺฉุงูู ุฏุณุชูุฑุงุช ูุฏุฑุช
  `/users` - ูุดุงูุฏู ูุณุช ฺฉุงุฑุจุฑุงู
  `/block` - ูุณุฏูุฏ ฺฉุฑุฏู ฺฉุงุฑุจุฑ
  `/unblock` - ุฑูุน ูุณุฏูุฏุช ฺฉุงุฑุจุฑ
  `/sysinfo` - ุงุทูุงุนุงุช ุณุณุชู
  `/logs` - ูุดุงูุฏู ูุงฺฏโูุง"""

    # ูพุงู ุงูุชูุง
    help_msg += """

๐ ุฏุฑ ุตูุฑุช ุจุฑูุฒ ูุดฺฉู ุจุง ุงุฏูู ุชูุงุณ ุจฺฏุฑุฏ."""

    return help_msg

@debug_decorator
def generate_admin_help() -> str:
    """
    ุชููุฏ ูพุงู ุฑุงูููุง ุงุฏูู

    Returns:
        ูุชู ุฑุงูููุง ุงุฏูู
    """
    admin_help = """๐ *ุฑุงูููุง ุฏุณุชูุฑุงุช ูุฏุฑุช:*

โพ๏ธ *ูุฏุฑุช ฺฉุงุฑุจุฑุงู:*
  `/users` - ูุดุงูุฏู ูุณุช ฺฉุงุฑุจุฑุงู
  `/block [user_id]` - ูุณุฏูุฏ ฺฉุฑุฏู ฺฉุงุฑุจุฑ
  `/unblock [user_id]` - ุฑูุน ูุณุฏูุฏุช ฺฉุงุฑุจุฑ
  `/setadmin [user_id]` - ุชูุธู ฺฉุงุฑุจุฑ ุจู ุนููุงู ุงุฏูู
  `/setpremium [user_id]` - ุชูุธู ฺฉุงุฑุจุฑ ุจู ุนููุงู ูฺู

โพ๏ธ *ูุฏุฑุช ุณุณุชู:*
  `/sysinfo` - ูุดุงูุฏู ุงุทูุงุนุงุช ุณุณุชู
  `/logs [count]` - ูุดุงูุฏู ูุงฺฏโูุง ุงุฎุฑ
  `/broadcast [message]` - ุงุฑุณุงู ูพุงู ุจู ููู ฺฉุงุฑุจุฑุงู

โพ๏ธ *ูุฏุฑุช ุฏุงูููุฏูุง:*
  `/downloads` - ูุดุงูุฏู ููู ุฏุงูููุฏูุง
  `/cancelall` - ูุบู ููู ุฏุงูููุฏูุง ุฏุฑ ุญุงู ุงูุฌุงู"""

    return admin_help